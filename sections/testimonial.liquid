<div
  class="section-testimonial{% if section.settings.show_avatar %} show-avatar{% endif %}"
  style="--bg-img: url({{ 'wave-left-right-white.png' | asset_url }});"
>
  {%- if section.settings.show_avatar -%}
    <figure class="testimonial-avatar">
      <img
        {% render 'srcset', image: section.settings.avatar, width: 300 %}
        alt="{{ section.settings.quote | escape }}"
        loading="lazy"
      />
    </figure>
  {%- endif -%}

  <div class="container section-padding side-padding text-center richtext">
    <div class="text-accent">
      {%- for i in (1..section.settings.rating) -%}
        {% render 'icon-star' %}
      {%- endfor -%}
    </div>

    <blockquote class="container-half h3-body">
      <p>{{ section.settings.quote | newline_to_br }}</p>
    </blockquote>
    <p>— {{ section.settings.author }}</p>
  </div>
</div>

{% stylesheet %}
  .section-testimonial {
    position: relative;
    background:
      var(--accent-2)
      var(--bg-img)
      center/cover no-repeat;
    color: #fff;
  }

  .section-testimonial.show-avatar {
    --avatar-size: calc(200px - 3rem);
    padding-top: calc(var(--avatar-size) / 2);
  }

  .section-testimonial .container {
    padding-block: 2rem 4rem;
  }

  .testimonial-avatar {
    position: absolute;
    left: 50%; top: 0;
    transform: translate(-50%, -50%);
    width: var(--avatar-size);
    height: var(--avatar-size);
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Testimonial",
  "tag": "section",
  "settings": [
    {
      "type": "range",
      "id": "rating",
      "label": "Rating",
      "unit": "★",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 5
    },
    {
      "type": "textarea",
      "id": "quote",
      "label": "Quote",
      "default": "Perfectly sized to fit. Love the material;\nseems extremely tough"
    },
    {
      "type": "text",
      "id": "author",
      "label": "Author",
      "default": "Hugh C."
    },
    {
      "type": "image_picker",
      "id": "avatar",
      "label": "Avatar"
    },
    {
      "type": "checkbox",
      "id": "show_avatar",
      "label": "Show avatar",
      "default": true
    }
  ]
}
{% endschema %}
