(()=>{var a=document.querySelector.bind(document),l=document.querySelectorAll.bind(document);function p(o,t){let e=0;return function(...n){clearTimeout(e),e=setTimeout(o.bind(this,...n),t||0)}}var y=l("form.search-form");for(let o of y){let t=o.querySelector('input[name="q"]'),e=o.querySelector(".search-suggestions"),n=a("#suggestion-group-template"),s=a("#suggestion-item-template");t.addEventListener("keyup",p(async g=>{let f=await h(g.target.value);e.innerHTML="",e.dataset.query=g.target.value;for(let[d,c]of Object.entries(f))if(c.length){let u=n.content.cloneNode(!0);u.querySelector(".suggestion-group-title").textContent=d,c.map(r=>{let i=s.content.cloneNode(!0);if(i.querySelector(".suggestion-item-url").href=r.url,i.querySelector(".suggestion-item-title").textContent=r.title,!!r.featuredImage||!!r.image){let m=i.querySelector(".suggestion-item-img img");m.src=S(r.image||r.featuredImage,"100x100"),m.alt=r.featuredImage?r.featuredImage.alt:r.title}u.querySelector(".suggestion-group-list").appendChild(i)}),e.appendChild(u)}},window.predictiveSearchOptions.keyUpDelay))}async function h(o){let t=new URLSearchParams,{resources:e}=window.predictiveSearchOptions;t.set("q",o),t.set("resources[type]",e.type),t.set("resources[limit]",e.limit);let n=await fetch("/search/suggest.json?"+t.toString());return!!n.ok&&(await n.json()).resources.results}function S(o,t){let[e,n,s]=o.split(/\.(png|jpg|gif)/g);return`${e}_${t}.${n}${s}`}})();
